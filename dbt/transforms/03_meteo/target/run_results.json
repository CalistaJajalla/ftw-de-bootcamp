{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-08-26T15:39:35.694416Z", "invocation_id": "01efb72d-0201-4d73-8e52-98a582b86a5e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:33.394029Z", "completed_at": "2025-08-26T15:39:33.463108Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:33.463858Z", "completed_at": "2025-08-26T15:39:33.778019Z"}], "thread_id": "Thread-1", "execution_time": 0.38568639755249023, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.stg_meteo__manila", "compiled": true, "compiled_code": "\n\n-- Normalize types & naming; no business logic here.\nselect\n  toDate(date)                         as dte,\n  toFloat64(temp_min)                  as temp_min_c,\n  toFloat64(temp_max)                  as temp_max_c,\n  toFloat64(precipitation)             as precip_mm,\n  toInt32(weather_code)                as weather_code\nfrom `raw`.`meteo___manila`", "relation_name": "`clean`.`stg_meteo__manila`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:33.992938Z", "completed_at": "2025-08-26T15:39:34.283326Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:34.306991Z", "completed_at": "2025-08-26T15:39:34.579874Z"}], "thread_id": "Thread-1", "execution_time": 0.6769416332244873, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    dte as unique_field,\n    count(*) as n_records\n\nfrom `clean`.`stg_meteo__manila`\nwhere dte is not null\ngroup by dte\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:33.799145Z", "completed_at": "2025-08-26T15:39:33.975375Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:34.059723Z", "completed_at": "2025-08-26T15:39:34.585876Z"}], "thread_id": "Thread-3", "execution_time": 0.7981443405151367, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dte\nfrom `clean`.`stg_meteo__manila`\nwhere dte is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:33.977289Z", "completed_at": "2025-08-26T15:39:34.107696Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:34.273111Z", "completed_at": "2025-08-26T15:39:34.696986Z"}], "thread_id": "Thread-2", "execution_time": 0.8322668075561523, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect temp_min_c\nfrom `clean`.`stg_meteo__manila`\nwhere temp_min_c is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:33.906453Z", "completed_at": "2025-08-26T15:39:34.009044Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:34.164771Z", "completed_at": "2025-08-26T15:39:34.722047Z"}], "thread_id": "Thread-4", "execution_time": 0.9262089729309082, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect temp_max_c\nfrom `clean`.`stg_meteo__manila`\nwhere temp_max_c is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:34.861463Z", "completed_at": "2025-08-26T15:39:34.898922Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:34.985689Z", "completed_at": "2025-08-26T15:39:35.467879Z"}], "thread_id": "Thread-2", "execution_time": 0.7011222839355469, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.vw_meteo__manila_weather", "compiled": true, "compiled_code": "\n\nwith daily as (\n  select\n    dte,\n    temp_min_c,\n    temp_max_c,\n    (temp_min_c + temp_max_c)/2.0 as temp_avg_c,\n    precip_mm,\n    weather_code\n  from `clean`.`stg_meteo__manila`\n),\ncodes as (\n  select\n    toInt32(weather_code)                as weather_code,\n    cast(night_description as String)    as condition\n  from `raw`.`meteo___wmo_codes`\n)\n\nselect\n  d.dte,\n  d.temp_min_c,\n  d.temp_max_c,\n  d.temp_avg_c,\n  d.precip_mm,\n  d.weather_code,\n  c.condition\nfrom daily d\nleft join codes c\n  on c.weather_code = d.weather_code\norder by d.dte", "relation_name": "`mart`.`vw_meteo__manila_weather`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:34.774487Z", "completed_at": "2025-08-26T15:39:34.879190Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:34.881570Z", "completed_at": "2025-08-26T15:39:35.621132Z"}], "thread_id": "Thread-1", "execution_time": 0.8576931953430176, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.mart_meteo__manila_daily", "compiled": true, "compiled_code": "\n\n-- Force non-nullable key for MergeTree\nselect\n  assumeNotNull(dte)                         as dte,          -- \ud83d\udc48 non-nullable\n  temp_min_c,\n  temp_max_c,\n  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,\n  precip_mm,\n  weather_code\nfrom `clean`.`stg_meteo__manila`", "relation_name": "`mart`.`mart_meteo__manila_daily`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T15:39:34.791361Z", "completed_at": "2025-08-26T15:39:34.891892Z"}, {"name": "execute", "started_at": "2025-08-26T15:39:34.959804Z", "completed_at": "2025-08-26T15:39:35.680636Z"}], "thread_id": "Thread-3", "execution_time": 0.9155659675598145, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.mart_meteo__manila_monthly", "compiled": true, "compiled_code": "\n\nwith base as (\n  select\n    assumeNotNull(dte)                            as dte_nn,   -- \ud83d\udc48 non-nullable\n    toFloat64(temp_min_c)                         as temp_min_c,\n    toFloat64(temp_max_c)                         as temp_max_c,\n    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,\n    toFloat64(precip_mm)                          as precip_mm\n  from `clean`.`stg_meteo__manila`\n)\nselect\n  toStartOfMonth(dte_nn)                as month,             -- \ud83d\udc48 computed from non-null date\n  avg(temp_min_c)                       as avg_min_c,\n  avg(temp_max_c)                       as avg_max_c,\n  avg(temp_avg_c)                       as avg_temp_c,\n  sum(precip_mm)                        as total_precip_mm,\n  countIf(precip_mm > 0)                as rainy_days\nfrom base\ngroup by month\norder by month", "relation_name": "`mart`.`mart_meteo__manila_monthly`"}], "elapsed_time": 3.3159799575805664, "args": {"exclude": [], "introspect": true, "populate_cache": true, "use_colors": true, "target": "local", "which": "build", "log_level": "info", "log_format": "default", "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "enable_legacy_logger": false, "indirect_selection": "eager", "partial_parse": true, "empty": false, "select": [], "cache_selected_only": false, "log_level_file": "debug", "send_anonymous_usage_stats": true, "show": false, "log_file_max_bytes": 10485760, "macro_debugging": false, "log_path": "/workdir/transforms/03_meteo/logs", "exclude_resource_types": [], "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt build --profiles-dir . --target local", "strict_mode": false, "project_dir": "/workdir/transforms/03_meteo", "write_json": true, "printer_width": 80, "use_colors_file": true, "vars": {}, "defer": false, "profiles_dir": ".", "require_resource_names_without_spaces": false, "print": true, "source_freshness_run_project_hooks": false, "include_saved_query": false, "export_saved_queries": false, "resource_types": [], "log_format_file": "debug", "favor_state": false, "static_parser": true, "version_check": true, "partial_parse_file_diff": true}}