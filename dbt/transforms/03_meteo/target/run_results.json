{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-08-26T17:20:19.406428Z", "invocation_id": "77875404-3f8d-4e79-b310-76421c781df2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:17.109927Z", "completed_at": "2025-08-26T17:20:17.125863Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:17.127355Z", "completed_at": "2025-08-26T17:20:17.622385Z"}], "thread_id": "Thread-1", "execution_time": 0.5370304584503174, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.stg_meteo__manila", "compiled": true, "compiled_code": "\n\n-- Normalize types & naming; no business logic here.\nselect\n  toDate(date)                         as dte,\n  toFloat64(temp_min)                  as temp_min_c,\n  toFloat64(temp_max)                  as temp_max_c,\n  toFloat64(precipitation)             as precip_mm,\n  toInt32(weather_code)                as weather_code\nfrom `raw`.`meteo___manila`", "relation_name": "`clean`.`stg_meteo__manila`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:17.089514Z", "completed_at": "2025-08-26T17:20:17.126630Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:17.198793Z", "completed_at": "2025-08-26T17:20:17.688845Z"}], "thread_id": "Thread-2", "execution_time": 0.6555447578430176, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.stg_meteo__regions_daily", "compiled": true, "compiled_code": "-- models/clean/stg_meteo__regions_daily.sql\n\n\nselect\n  cast(region_code as String)          as region_code,\n  cast(region_name as String)          as region_name,\n  toFloat64(latitude)                  as latitude,\n  toFloat64(longitude)                 as longitude,\n  toDate(date)                         as dte,\n  toFloat64(temp_min)                  as temp_min_c,\n  toFloat64(temp_max)                  as temp_max_c,\n  toFloat64(precipitation)             as precip_mm,\n  toInt32(weather_code)                as weather_code\nfrom `raw`.`meteo___regions_daily`", "relation_name": "`clean`.`stg_meteo__regions_daily`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:17.794008Z", "completed_at": "2025-08-26T17:20:17.927563Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:17.930832Z", "completed_at": "2025-08-26T17:20:18.028224Z"}], "thread_id": "Thread-1", "execution_time": 0.3230428695678711, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect temp_min_c\nfrom `clean`.`stg_meteo__manila`\nwhere temp_min_c is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:17.801354Z", "completed_at": "2025-08-26T17:20:17.928774Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:17.987461Z", "completed_at": "2025-08-26T17:20:18.090078Z"}], "thread_id": "Thread-2", "execution_time": 0.3831655979156494, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    dte as unique_field,\n    count(*) as n_records\n\nfrom `clean`.`stg_meteo__manila`\nwhere dte is not null\ngroup by dte\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:18.115860Z", "completed_at": "2025-08-26T17:20:18.123131Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:18.123860Z", "completed_at": "2025-08-26T17:20:18.217006Z"}], "thread_id": "Thread-1", "execution_time": 0.10292553901672363, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.vw_meteo__regions_latest", "compiled": true, "compiled_code": "-- models/mart/vw_meteo__regions_latest.sql\n\n\nwith last_dates as (\n  select region_code, max(dte) as dte_max\n  from `clean`.`stg_meteo__regions_daily`\n  group by region_code\n)\nselect\n  s.region_code,\n  s.region_name,\n  s.latitude,\n  s.longitude,\n  s.dte,\n  s.temp_min_c,\n  s.temp_max_c,\n  (s.temp_min_c + s.temp_max_c)/2.0 as temp_avg_c,\n  s.precip_mm,\n  s.weather_code\nfrom `clean`.`stg_meteo__regions_daily` s\njoin last_dates ld\n  on s.region_code = ld.region_code and s.dte = ld.dte_max\norder by s.region_code", "relation_name": "`mart`.`vw_meteo__regions_latest`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:17.784830Z", "completed_at": "2025-08-26T17:20:17.816583Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:17.827078Z", "completed_at": "2025-08-26T17:20:18.241822Z"}], "thread_id": "Thread-3", "execution_time": 0.5396597385406494, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect temp_max_c\nfrom `clean`.`stg_meteo__manila`\nwhere temp_max_c is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:17.708389Z", "completed_at": "2025-08-26T17:20:17.806479Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:17.821886Z", "completed_at": "2025-08-26T17:20:18.247498Z"}], "thread_id": "Thread-4", "execution_time": 0.5474708080291748, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dte\nfrom `clean`.`stg_meteo__manila`\nwhere dte is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:18.331023Z", "completed_at": "2025-08-26T17:20:18.420819Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:18.504353Z", "completed_at": "2025-08-26T17:20:19.219502Z"}], "thread_id": "Thread-3", "execution_time": 0.9158527851104736, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.vw_meteo__manila_weather", "compiled": true, "compiled_code": "\n\nwith daily as (\n  select\n    dte,\n    temp_min_c,\n    temp_max_c,\n    (temp_min_c + temp_max_c)/2.0 as temp_avg_c,\n    precip_mm,\n    weather_code\n  from `clean`.`stg_meteo__manila`\n),\ncodes as (\n  select\n    toInt32(weather_code)                as weather_code,\n    cast(night_description as String)    as condition\n  from `raw`.`meteo___wmo_codes`\n)\n\nselect\n  d.dte,\n  d.temp_min_c,\n  d.temp_max_c,\n  d.temp_avg_c,\n  d.precip_mm,\n  d.weather_code,\n  c.condition\nfrom daily d\nleft join codes c\n  on c.weather_code = d.weather_code\norder by d.dte", "relation_name": "`mart`.`vw_meteo__manila_weather`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:18.310621Z", "completed_at": "2025-08-26T17:20:18.396133Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:18.398387Z", "completed_at": "2025-08-26T17:20:19.321167Z"}], "thread_id": "Thread-2", "execution_time": 1.0207781791687012, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.mart_meteo__manila_daily", "compiled": true, "compiled_code": "\n\n-- Force non-nullable key for MergeTree\nselect\n  assumeNotNull(dte)                         as dte,          -- \ud83d\udc48 non-nullable\n  temp_min_c,\n  temp_max_c,\n  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,\n  precip_mm,\n  weather_code\nfrom `clean`.`stg_meteo__manila`", "relation_name": "`mart`.`mart_meteo__manila_daily`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T17:20:18.322394Z", "completed_at": "2025-08-26T17:20:18.403635Z"}, {"name": "execute", "started_at": "2025-08-26T17:20:18.410494Z", "completed_at": "2025-08-26T17:20:19.329268Z"}], "thread_id": "Thread-1", "execution_time": 1.0272860527038574, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ex_03_meteo.mart_meteo__manila_monthly", "compiled": true, "compiled_code": "\n\nwith base as (\n  select\n    assumeNotNull(dte)                            as dte_nn,   -- \ud83d\udc48 non-nullable\n    toFloat64(temp_min_c)                         as temp_min_c,\n    toFloat64(temp_max_c)                         as temp_max_c,\n    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,\n    toFloat64(precip_mm)                          as precip_mm\n  from `clean`.`stg_meteo__manila`\n)\nselect\n  toStartOfMonth(dte_nn)                as month,             -- \ud83d\udc48 computed from non-null date\n  avg(temp_min_c)                       as avg_min_c,\n  avg(temp_max_c)                       as avg_max_c,\n  avg(temp_avg_c)                       as avg_temp_c,\n  sum(precip_mm)                        as total_precip_mm,\n  countIf(precip_mm > 0)                as rainy_days\nfrom base\ngroup by month\norder by month", "relation_name": "`mart`.`mart_meteo__manila_monthly`"}], "elapsed_time": 3.499933958053589, "args": {"use_colors_file": true, "target": "local", "include_saved_query": false, "empty": false, "macro_debugging": false, "printer_width": 80, "resource_types": [], "cache_selected_only": false, "log_file_max_bytes": 10485760, "warn_error_options": {"include": [], "exclude": []}, "which": "build", "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "write_json": true, "log_level": "info", "static_parser": true, "export_saved_queries": false, "enable_legacy_logger": false, "log_format_file": "debug", "favor_state": false, "use_colors": true, "partial_parse": true, "introspect": true, "source_freshness_run_project_hooks": false, "invocation_command": "dbt build --profiles-dir . --target local", "show": false, "profiles_dir": ".", "require_resource_names_without_spaces": false, "vars": {}, "exclude_resource_types": [], "show_resource_report": false, "strict_mode": false, "indirect_selection": "eager", "select": [], "project_dir": "/workdir/transforms/03_meteo", "partial_parse_file_diff": true, "defer": false, "quiet": false, "log_path": "/workdir/transforms/03_meteo/logs", "version_check": true, "exclude": [], "log_level_file": "debug", "print": true, "log_format": "default"}}